Version 4
SHEET 1 2088 1364
WIRE -208 -144 -576 -144
WIRE 16 -144 -208 -144
WIRE -576 -48 -576 -144
WIRE -576 -48 -656 -48
WIRE -496 -48 -576 -48
WIRE -656 32 -656 -48
WIRE -496 32 -496 -48
WIRE 16 80 16 -144
WIRE 288 80 16 80
WIRE 384 80 288 80
WIRE 608 80 496 80
WIRE 752 80 672 80
WIRE 816 80 752 80
WIRE 976 80 896 80
WIRE 1072 80 976 80
WIRE 1136 80 1072 80
WIRE 1136 96 1136 80
WIRE -208 112 -208 -144
WIRE 288 112 288 80
WIRE 384 112 384 80
WIRE 496 112 496 80
WIRE 752 112 752 80
WIRE 976 112 976 80
WIRE 16 128 16 80
WIRE -656 144 -656 96
WIRE -624 144 -656 144
WIRE -496 144 -496 96
WIRE -496 144 -544 144
WIRE -656 192 -656 144
WIRE -496 192 -496 144
WIRE 288 224 288 192
WIRE 288 224 208 224
WIRE 384 224 384 192
WIRE 384 224 288 224
WIRE 496 240 496 192
WIRE 752 240 752 176
WIRE 976 240 976 176
WIRE 16 256 16 208
WIRE 208 256 208 224
WIRE 1136 256 1136 176
WIRE -656 272 -656 256
WIRE -576 272 -656 272
WIRE -496 272 -496 256
WIRE -496 272 -576 272
WIRE -576 288 -576 272
WIRE -208 288 -208 176
WIRE 160 336 144 336
WIRE 16 400 16 320
WIRE 208 400 208 352
WIRE -704 544 -704 528
WIRE 1072 560 1072 80
WIRE 144 576 112 576
WIRE 224 576 208 576
WIRE 320 576 304 576
WIRE 672 576 624 576
WIRE 816 576 752 576
WIRE -112 592 -144 592
WIRE 0 592 -32 592
WIRE -704 640 -704 624
WIRE 816 656 816 576
WIRE 816 656 752 656
WIRE 832 656 816 656
WIRE 1072 656 1072 640
WIRE 1072 656 912 656
WIRE 320 672 320 576
WIRE 320 672 288 672
WIRE 336 672 320 672
WIRE 624 672 624 576
WIRE 624 672 416 672
WIRE 688 672 624 672
WIRE 1072 672 1072 656
WIRE 0 688 0 592
WIRE 0 688 -32 688
WIRE 16 688 0 688
WIRE 112 688 112 576
WIRE 112 688 96 688
WIRE 160 688 112 688
WIRE 224 688 160 688
WIRE 784 688 752 688
WIRE -144 704 -144 592
WIRE -144 704 -528 704
WIRE -96 704 -144 704
WIRE 320 704 288 704
WIRE 784 704 784 688
WIRE -704 720 -704 704
WIRE -656 720 -704 720
WIRE -592 720 -656 720
WIRE 0 720 -32 720
WIRE 320 720 320 704
WIRE -704 736 -704 720
WIRE -480 736 -528 736
WIRE 0 736 0 720
WIRE 816 736 816 656
WIRE -480 768 -480 736
WIRE 1072 768 1072 752
WIRE -704 816 -704 800
WIRE 816 848 816 816
WIRE -480 864 -480 848
WIRE -704 912 -704 896
WIRE 816 944 816 928
FLAG 496 240 0
FLAG 752 240 0
FLAG 976 240 0
FLAG 1136 256 0
FLAG 208 400 0
FLAG 16 400 0
FLAG -576 288 0
FLAG -208 288 0
FLAG 144 336 Vgl
FLAG -656 720 Vgl
FLAG 1072 768 0
FLAG 784 704 0
FLAG 816 944 0
FLAG 320 720 0
FLAG 0 736 0
FLAG -480 864 0
FLAG -704 912 0
FLAG -704 528 0
FLAG 160 688 Vo_int
FLAG 224 896 0
FLAG 224 816 +
FLAG 256 656 +
FLAG 288 896 0
FLAG 288 816 -
FLAG 256 720 -
SYMBOL ind2 368 96 R0
SYMATTR InstName L1
SYMATTR Value 300µ
SYMATTR Type ind
SYMATTR SpiceLine Rser=2m
SYMBOL ind2 480 96 R0
SYMATTR InstName L2
SYMATTR Value 152µ
SYMATTR Type ind
SYMBOL ind 800 96 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L4
SYMATTR Value 400µ
SYMATTR SpiceLine Rser=20m
SYMBOL cap 960 112 R0
SYMATTR InstName C1
SYMATTR Value 100µ
SYMATTR SpiceLine Rser=10m
SYMBOL res 1120 80 R0
SYMATTR InstName R1
SYMATTR Value 6.71
SYMBOL nmos 160 256 R0
SYMATTR InstName M2
SYMATTR Value AOD280A60
SYMBOL diode 32 320 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D5
SYMBOL diode 608 96 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMBOL diode 768 176 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2
SYMBOL ind 272 96 R0
SYMATTR InstName L3
SYMATTR Value 5m
SYMBOL voltage -640 144 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -32 56 Invisible 2
WINDOW 123 0 0 Left 0
SYMATTR InstName Vac
SYMATTR Value SINE(0 {Vac*sqrt(2)} 50)
SYMATTR SpiceLine Rser=10m
SYMBOL diode -512 256 M180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D7
SYMBOL diode -640 256 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D8
SYMBOL cap -224 112 R0
SYMATTR InstName C2
SYMATTR Value 220µ
SYMATTR SpiceLine Rser=0.1
SYMBOL res 1056 544 R0
SYMATTR InstName R2
SYMATTR Value 47k
SYMBOL res 1056 656 R0
SYMATTR InstName R3
SYMATTR Value 1k
SYMBOL OpAmps\\UniversalOpAmp 720 672 M0
SYMATTR InstName U1
SYMBOL res 928 640 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 100k
SYMBOL res 832 832 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R5
SYMATTR Value 100k
SYMBOL voltage 816 944 M180
WINDOW 0 24 96 Left 2
WINDOW 3 24 16 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 1
SYMBOL res 768 560 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 100k
SYMBOL res 432 656 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 10k
SYMBOL res 320 560 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 200k
SYMBOL OpAmps\\UniversalOpAmp -64 704 M0
SYMATTR InstName U4
SYMBOL res 112 672 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 100k
SYMBOL res -16 576 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 100k
SYMBOL cap 208 560 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value 2µ
SYMBOL OpAmps\\UniversalOpAmp -560 720 R180
SYMATTR InstName U2
SYMATTR Value2 Avol=1Meg GBW=100G Vos=0
SYMBOL voltage -480 752 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 24 44 Invisible 2
SYMATTR Value PULSE(0 4 0 {(1-1e-3)/fsw} {1e-3/fsw} 0 {1/fsw})
SYMATTR InstName Vst
SYMBOL diode -688 704 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D9
SYMBOL diode -688 800 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D10
SYMBOL voltage -704 640 M180
WINDOW 0 24 96 Left 2
WINDOW 3 24 16 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value {Vsw-0.7}
SYMBOL voltage -704 800 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value 0.7
SYMBOL OpAmps\\UniversalOpAmp2 256 688 M0
SYMATTR InstName U5
SYMBOL voltage 224 800 M0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName INT_LIM+
SYMATTR Value 2
SYMBOL voltage 288 800 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName INT_LIM_-
SYMATTR Value -2
SYMBOL diode -512 96 M180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D3
SYMBOL diode -640 96 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D4
SYMBOL ind2 32 224 R180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName L5
SYMATTR Value 300µ
SYMATTR Type ind
TEXT 392 56 Left 2 !K L1 L2 L5 1
TEXT -1464 352 Left 2 !.tran 0 50m 0 uic
TEXT -1464 376 Left 2 !.param Vac=110 fsw=125k Vsw=12
TEXT -1360 592 Left 2 ;AOD280A60:\nD=0.22@220Vrms\nDmin=0.2@240Vrms\nDmax=0.5@110Vrms
TEXT 408 264 Left 2 ;1.41:1
TEXT 120 768 Left 2 !.ic V(Vo_int)=0
TEXT -616 512 Left 2 ;PWM
TEXT 16 512 Left 2 ;Controlador PI
TEXT 640 512 Left 2 ;Amplificador de error
TEXT 1080 504 Left 2 ;y(t)
TEXT 768 832 Left 2 ;u(t)
TEXT 496 688 Left 2 ;e(t)
TEXT -432 688 Left 1 ;e(t)*R10/R9 + int(e(t))/(R9*C3)
TEXT -344 728 Left 2 ;Kp=R10/R9\nKi=1/(R9*C3)
TEXT 944 632 Left 2 ;y(t)/48
